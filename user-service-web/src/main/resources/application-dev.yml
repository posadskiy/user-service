#tag::micronaut[]
micronaut:
  server:
    cors:
      enabled: true
      allowed-origins:
        - http://localhost:3000
      allowed-methods:
        - GET
        - POST
        - PUT
        - DELETE
        - OPTIONS
      allowed-headers: "*"
      allow-credentials: true
  security:
    intercept-url-map:
      - pattern: /v3/api-docs/**
        access: isAnonymous()
      - pattern: /health
        access: isAnonymous()
      - pattern: /signup
        access: isAnonymous()
  endpoints:
    health:
      enabled: true
      sensitive: false
      details:
        enabled: true
#end::micronaut[]

#tag::database[]
datasources:
  default:
    url: jdbc:postgresql://localhost:5432/auth_db
    username: ${AUTH_DATABASE_USER}
    password: ${AUTH_DATABASE_PASSWORD}
    hikari:
      maximum-pool-size: ${DB_MAX_POOL_SIZE:5}
      minimum-idle: ${DB_MIN_IDLE:2}
      connection-timeout: ${DB_CONNECTION_TIMEOUT:30000}
      idle-timeout: ${DB_IDLE_TIMEOUT:600000}
      max-lifetime: ${DB_MAX_LIFETIME:1800000}
#end::database[]

#tag::jaeger[]
tracing:
  jaeger:
    sampler:
      probability: 1
#end::jaeger[]

#tag::logging[]
logging:
  level:
    com.posadskiy.user: ${LOG_LEVEL_APP:DEBUG}
    io.micronaut: ${LOG_LEVEL_MICRONAUT:INFO}
    org.hibernate.SQL: ${LOG_LEVEL_SQL:DEBUG}
    org.hibernate.type.descriptor.sql.BasicBinder: ${LOG_LEVEL_SQL_PARAMS:DEBUG}
#end::logging[]
